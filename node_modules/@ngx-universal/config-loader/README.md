# @ngx-universal/config-loader
Loader for [@ngx-config/core] that provides application settings to **browser**/**server** platforms

[![Linux build](https://travis-ci.org/ngx-universal/config-loader.svg?branch=master)](https://travis-ci.org/ngx-universal/config-loader) [![Windows build](https://ci.appveyor.com/api/projects/status/github/ngx-universal/config-loader?branch=master&svg=true)](https://ci.appveyor.com/project/ngx-universal/config-loader) [![coverage](https://codecov.io/github/ngx-universal/config-loader/coverage.svg?branch=master)](https://codecov.io/gh/ngx-universal/config-loader) [![npm version](https://badge.fury.io/js/%40ngx-universal%2Fconfig-loader.svg)](https://www.npmjs.com/package/@ngx-universal/config-loader)

> Please support this project by simply putting a Github star. Share this library with friends on Twitter and everywhere else you can.

## Table of contents:
- [Prerequisites](#prerequisites)
- [Getting started](#getting-started)
  - [Installation](#installation)
	- [Examples](#examples)
	- [Related packages](#related-packages)
	- [Adding `@ngx-universal/config-loader` to your project (SystemJS)](#adding-ngx-universalconfig-loader-to-your-project-systemjs)
- [Settings](#settings)
	- [Setting up `ConfigModule` to use `UniversalConfigLoader`](#setting-up-configmodule-to-use-universalconfigloader)
- [License](#license)

## Prerequisites
This package depends on `@angular v4.0.0`. Older versions contain outdated dependencies, might produce errors.

Also, please ensure that you are using **`Typescript v2.1.6`** or higher.

## Getting started
### Installation
You can install **`@ngx-universal/config-loader`** using `npm`
```
npm install @ngx-universal/config-loader --save
```

**Note**: You should have already installed [@ngx-config/core].

### Examples
- [ng-seed/universal] is an officially maintained seed project, showcasing common patterns and best practices for **`@ngx-universal/config-loader`**.

### Related packages
The following packages may be used in conjunction with **`@ngx-universal/config-loader`**:
- [@ngx-config/core]
- [@ngx-config/http-loader]
- [@ngx-config/fs-loader]

### Adding `@ngx-universal/config-loader` to your project (SystemJS)
Add `map` for **`@ngx-universal/config-loader`** in your `systemjs.config`
```javascript
'@ngx-universal/config-loader': 'node_modules/@ngx-universal/config-loader/bundles/config-loader.umd.min.js'
```

## Settings
### Setting up `ConfigModule` to use `UniversalConfigLoader`
`UniversalConfigLoader` requires a `browserLoader` and a `serverLoader` to load application settings on both platforms.
- Import `ConfigModule` using the mapping `'@ngx-config/core'` and append `ConfigModule.forRoot({...})` within the imports property of **app.module**.
- Import `UniversalConfigLoader` using the mapping `'@ngx-universal/config-loader'`.

**Note**: *Considering the app.module is the core module in Angular application*.

#### config.json
```json
{
  "system": {
    "applicationName": "Mighty Mouse",
    "applicationUrl": "http://localhost:8000"
  },
  "seo": {
    "pageTitle": "Tweeting bird"
  },
  "i18n":{
    "locale": "en"
  }
}
```

#### app.module.ts
```TypeScript
...
import { ConfigModule, ConfigLoader, ConfigStaticLoader } from '@ngx-config/core';
import { ConfigFsLoader } from '@ngx-config/fs-loader';
import { ConfigHttpLoader } from '@ngx-config/http-loader';
import { UniversalConfigLoader } from '@ngx-universal/config-loader';
...

export function configFactory(platformId: any, http: Http): ConfigLoader {
  const serverLoader = new ConfigFsLoader('./public/assets/config.json'); // FILE PATH
  const browserLoader = new ConfigHttpLoader(http, './assets/config.json'); // API ENDPOINT

  return new UniversalConfigLoader(platformId, serverLoader, browserLoader);
}

@NgModule({
  declarations: [
    AppComponent,
    ...
  ],
  ...
  imports: [
    ConfigModule.forRoot({
      provide: ConfigLoader,
      useFactory: (configFactory),
      deps: [PLATFORM_ID, Http]
    }),
    ...
  ],
  ...
  bootstrap: [AppComponent]
})
export class AppModule {
  constructor(@Inject(PLATFORM_ID) private readonly platformId: any) {
  }
}
```

`UniversalConfigLoader` has two parameters:
- **serverLoader**: `ConfigLoader` : the loader which will run on the `server` platform (*ex: `ConfigFsLoader`, or `ConfigStaticLoader`*)
- **browserLoader**: `ConfigLoader` : the loader which will run on the `browser` platform (*ex: `ConfigHttpLoader`, or `ConfigStaticLoader`*)

> :+1: Well! **`@ngx-universal/config-loader`** will now provide **application settings** to **browser**/**server** platforms.

## License
The MIT License (MIT)

Copyright (c) 2017 [Burak Tasci]

[@ngx-config/core]: https://github.com/ngx-config/core
[ng-seed/universal]: https://github.com/ng-seed/universal
[@ngx-config/http-loader]: https://github.com/ngx-config/http-loader
[@ngx-config/fs-loader]: https://github.com/ngx-config/fs-loader
[Burak Tasci]: https://github.com/fulls1z3
